<html>
<head>
	  <link rel="icon" type="image/png" href="icons8-log-96.png">
	<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">

<style>
button {
	height: 100px;
	width: 100px;
	font-size: 300%;
	background-color: #007bff;
	color: white;
    border: none;
	border-radius: 5px;
	cursor: pointer;
	touch-action: manipulation; /* Control touch gestures */
	transition: background-color 0.3s, transform 0.1s;
}
#logbtn {
	width: 150px;
	color: black
}
</style>
</head>
<body>
<button data-type="primary" data-key="up" onclick="press(this)">↑</button>
<button data-type="primary" data-key="down" onclick="press(this)">↓</button>
<button data-type="primary" data-key="flat" onclick="press(this)">→</button>

<button data-type="modifier" onclick="press(this)">●</button>
<button data-type="modifier" onclick="press(this)">▲</button>
<button data-type="modifier" onclick="press(this)">■</button>
<button data-type="modifier" onclick="press(this)">X</button>

<button data-type="submit" id="logbtn" onclick="submitEntry()">L</button>

<button onclick="toggleNote()">＋</button>
<textarea id="note"
  placeholder="Optional note…"
  style="display:none; width:100%; margin-top:6px;">
</textarea>

<div id="preview" style="margin: 10px 0; font-weight: bold; opacity: 0.6;">
</body>
</html>

  (no entry)
</div>

<ul id="log"></ul>


<script>
function toggleNote() {
  const note = document.getElementById("note");
  note.style.display = note.style.display === "none" ? "block" : "none";
}

const counts = { up: 0, down: 0, flat: 0 };
let currentEntry = null;

function press(btn) {
  const type = btn.dataset.type;
  const label = btn.innerText;

  if (type === "primary") {
    currentEntry = {
      key: btn.dataset.key,
      primary: label,
      modifiers: [],
	  note: "",
      time: new Date()
    };
  }

  if (type === "modifier") {
    if (!currentEntry) return;
    currentEntry.modifiers.push(label);
  }

  updatePreview();
}

function submitEntry() {
  if (!currentEntry) return;

  counts[currentEntry.key]++;

const noteEl = document.getElementById("note");
currentEntry.note = noteEl.value.trim();
noteEl.value = "";
noteEl.style.display = "none";

  let text = 
    currentEntry.time.toLocaleTimeString() +
    " - " +
    buildEntryText() +
    " (" + counts[currentEntry.key] + ") ";

  if (currentEntry.note) {
    text += " - " + currentEntry.note;
  }

  const entry = document.createElement("li");
  entry.innerText = text;
  document.getElementById("log").appendChild(entry);
  currentEntry = null;
  updatePreview();
}

function buildEntryText() {
  return [
    currentEntry.primary,
    ...currentEntry.modifiers
  ].join(", ");
}

function updatePreview() {
  const preview = document.getElementById("preview");

  if (!currentEntry) {
    preview.innerText = "(no entry)";
    preview.style.opacity = 0.4;
    return;
  }

  preview.innerText = buildEntryText();
  preview.style.opacity = 1;
}
</script>
